<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>PlainScrollbar - a simple custom scrollbar</title>
	<script src="./polyfill.js" type="application/javascript"></script>
	<style type="text/css">
	/**
	 * common
	 */
	 
	html {
		box-sizing: border-box;
		font-family: sans-serif;
	}
	*, *:before, *:after {
		box-sizing: inherit;
	}
	
	fieldset,
	fieldset legend {
		display: inline-block;
		border: 1px solid #ccc;
		font-size: 12px;
	}

	fieldset {
		width: 80vw;
		margin: 0;
	}

	fieldset legend {
		padding: 3px 6px;
		font-size: 14px;
	}
	
	h1 small {
		color: #999;
	}

	/**
	 * #thing...
	 */
	
	#thingWrapper {
		position: relative;
		overflow: hidden;
		height: 55vh;
		width: 80vw;
		background-color: #ccc;
		border: 1px solid #ccc;
	}
	
	#thingContentWrapper {
		position: relative;
		overflow: hidden;
		height: 100%; /*calc(100% - 16px);*/
		width: calc(100% - 16px);
		border-color: #ccc;
		border-style: solid;
		border-width: 0 1px 1px 0;
	}
	
	#thingContent {
		position: relative;
		top: 0;
		min-height: 100%;
		min-width: 100%;
	}
	#thingContent span {
		display: table-row;
		height: 20px;
		font-size: 12px;
		line-height: 20px;
		white-space: nowrap;
		background-color: #eee;
	}
	#thingContent span:nth-child(even) {
		background-color: #f9f9f9;
	}
	#thingContent span:first-child,
	#thingContent span:last-child {
		background-color: rgba(0, 166, 182, 0.16);
	}
	
	#thingControl {
		margin-bottom: 1em;
	}
	
	#thingControl div {
		display: inline-block;
		margin-bottom: 0.25em;
	}
	
	</style>
	<link href="./plain-scrollbar.css" rel="stylesheet" type="text/css">
	<script src="./plain-scrollbar.js" type="application/javascript"></script>
	<style type="text/css">
	/**
	 * Some .plain-scrollbar style overloading
	 */

	.plain-scrollbar.scrollbar-horizontal .slider {
		top: 4px;
		height: 8px;
		border-radius: 8px;
	}

	.plain-scrollbar[data-scrollable="false"] {
		visibility: hidden;
	}

	.plain-scrollbar .slider {
		background-color: rgba(0, 130, 145, 0);
	}

	.plain-scrollbar:hover .slider,
	.plain-scrollbar[data-visible="true"] .slider {
		background-color: rgba(0, 130, 145, 0.9);
	}
	
	</style>
</head>
<body>

<h1>PlainScrollbar <small>a simple custom scrollbar</small></h1>

<p>
PlainScrollbar instances can be horizontal or vertical.
</p>

<h3>Example</h3>

<div id="thing">
	<div id="thingControl">
		<fieldset class="thing-wrapper">
			<legend>Adjust the vertical scrollbar numberOfItems configuration</legend>
			<div>
				<label for="totalValueInput">total</label>
				<input id="totalValueInput" type="number" value="">
			</div>
			<div>
				<label for="startValueInput">start</label>
				<input id="startValueInput" type="number" value="">
			</div>
			<div>
				<label>visible</label>
				<span id="visibleValueInput"></span>
			</div>
		</fieldset>	
	</div>

	<div id="thingWrapper">
		<div id="thingContentWrapper">
			<div id="thingContent"></div>
		</div>
		<div id="thingScrollbarVertical" class="scrollbar-wrapper" style="height: calc(100% - 17px);"></div>
		<div id="thingScrollbarHorizontal" class="scrollbar-wrapper" style="width: calc(100% - 17px);"></div>
	</div>
</div>

<script>



/**
 * Using & controlling PlainScrollbar
 */

var thingContentWrapperElement = document.getElementById('thingContentWrapper'),
	contentElement = document.getElementById('thingContent'),
	itemSizeVertical = 0,
	totalValueInputElement = document.getElementById('totalValueInput'),
	startValueInputElement = document.getElementById('startValueInput'),
	visibleValueInputElement = document.getElementById('visibleValueInput');
	
totalValueInputElement.value = 100;
startValueInputElement.value = 0;

changeNumberOfItems(totalValueInputElement.value);

// Init horizontal scrollbar
var horizontalScrollbar = new PlainScrollbar({
	// alwaysVisible: true,
	// arrows: true,
	movePageByPageOnAreaClick: false,
	numberOfItems: determineNumberOfItems('horizontal'),
	orientation: 'horizontal',
	onSet: function(numberOfItems) {
		contentElement.style['left'] = (numberOfItems.start  * -1) + 'px';
	},
	scrollbarElement: document.getElementById('thingScrollbarHorizontal'),
	wheelSpeed: 8,
});
	
// Init vertical scrollbar
var verticalScrollbar = new PlainScrollbar({
	alwaysVisible: true,
	arrows: true,
	numberOfItems: determineNumberOfItems('vertical'),
	orientation: 'vertical',
	onSet: function(numberOfItems) {
		contentElement.style['top'] = (numberOfItems.start * -itemSizeVertical) + 'px';
		startValueInputElement.value = numberOfItems.start;
	},
	scrollbarElement: document.getElementById('thingScrollbarVertical'),
});

// Controlling PlainScrollbar instances

contentElement.addEventListener('wheel', function(event) {
	event.preventDefault();
	verticalScrollbar.set(event);
	horizontalScrollbar.set(event);
}, false);

window.addEventListener('resize', function(event) {
	horizontalScrollbar.set(determineNumberOfItems('horizontal'));
	verticalScrollbar.set(determineNumberOfItems('vertical'));
}, false);

totalValueInputElement.addEventListener('keypress', function (event) {
	if ('Enter' === event.key) {
		event.preventDefault();
		changeNumberOfItems(totalValueInputElement.value);
		verticalScrollbar.set(determineNumberOfItems('vertical'));
    }
});
totalValueInputElement.addEventListener('blur', function(event) {
	event.preventDefault();
	changeNumberOfItems(totalValueInputElement.value);
	verticalScrollbar.set(determineNumberOfItems('vertical'));
}, false);

startValueInputElement.addEventListener('keypress', function (event) {
    if ('Enter' === event.key) {
		event.preventDefault();
		verticalScrollbar.set(determineNumberOfItems('vertical'));
    }
});
startValueInputElement.addEventListener('blur', function(event) {
	event.preventDefault();
	verticalScrollbar.set(determineNumberOfItems('vertical'));
}, false);

// helper functions

function changeNumberOfItems(total) {
	total = parseInt(total);
	var items = contentElement.getElementsByTagName('SPAN'),
		delta = total - items.length,
		iStart = items.length,
		iMax = (items.length + delta),
		i;

	if (delta > 0) {
		var buffer = contentElement.innerHTML;
		for (i = iStart; i < iMax; i++) {
			buffer += '<span>' + (i) + ' ' + String('~').repeat(Math.floor(Math.random() * Math.floor(125))) + '</span>';
		}
		contentElement.innerHTML = buffer;
	}

	if (delta < 0) {
		for (i = (iStart -1); i > (iMax -1); i--) {
			var child = items[i];
			//child.remove(); //< Does not exist in IE 11
			contentElement.removeChild(child);
		}
	}

	items = contentElement.getElementsByTagName('SPAN');
	if (items.length > 0) {
		var itemBoundingClientRect = items[0].getBoundingClientRect(); //< Assume that all items have the same height.
		itemSizeVertical = itemBoundingClientRect.height;
	} else {
		itemSizeVertical = 0;
	}
}

function determineNumberOfItems(orientation) {
	var numberOfItems = {};
	switch(orientation) {
		case 'horizontal':
			numberOfItems = {
				start: 0,
				total: contentElement.scrollWidth,
				visible: Math.round(thingContentWrapperElement.clientWidth),
			};
			break;

		case 'vertical':
			numberOfItems = {
				start: parseFloat(startValueInputElement.value),
				total: parseInt(totalValueInputElement.value),
				visible: thingContentWrapperElement.clientHeight / itemSizeVertical,
			};
			visibleValueInputElement.innerHTML = numberOfItems.visible;
			break;
	}
	return numberOfItems;
}

</script>

</body>
</html>
